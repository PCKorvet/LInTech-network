# LInTech - плата Головной Машины
![3D  модель платы](./KiCad/LInTech-GM.png)

В данный момент работа над реконструкцией платой в стадии завершения. Уточняются номиналы компонентов и несколько линий.

Плата воссоздана Night Gryphon по фотографиям, предоставленым Arseny, и с непосредственной помощью Arseny в изучении разводки оригинала платы.
Также спасибо Maxiol и Станиславу Масловски за помощь в определении/воссоздании логики работы аналоговой части схемы.

Библиотека прошивок микроконтроллера платы любезно предоставлена Станиславом Кононовым из ЛИнТех при содействии Argent.

Reference_Photo - исходные фото по которым велась реконструкция
KiCad - исходный проект реконструкции платы в формате KiCad
Gerbers - GERBER файлы для изготовления реплики (будут сгенерированы по завершению  реконструкции схемы)
Firmware - микропрограмма контроллера Intel 8051
Schematic.pdf - реконструированая схема платы

## Техническое описание
[WIP]
Плата построена на базе микроконтроллера Intel 8051 - DD1.
 
ОЗУ контроллера расширено ДД4 573РУ10. Возможно размещение в этом ОЗУ как данных так и исполнение кода.
Возможна работа с микропрограммой во внешнем ПЗУ ДД5 (требует уточнения) после установки джампера Х5 в положение 2-3.

Адресное пространство контроллера разбито на 4 части по старшим битам адреса 14 и 15, реализуется дешифратором ДД3:
- В старшей части 0xFххх расположен порт данных обмена с РС. 
- В адресах 0х4ххх расположено дополнительное ОЗУ
- В адресах 0х0ххх (предположительно) может быть установлено дополнительное ПЗУ ДД5

При записи от РС в порт данных выдается прерывание Int0 (триггер ДД13-А). Младший бит адреса порта данных в который производилась запись может быть прочитана из Р3 бит 4.

При чтении РС из порта данных выдается прерывание Int1 (триггер ДД13-Б)

Для запроса прерывания РС необходимо выставить "1" в Р3 бит 5.

При перезагрузке РС по сигналу RESET на шине ISA микроконтроллер так же переводится в ресет до снятия бита ресета со стороны РС записью "0" в порт управления платой.

Обмен с линией осуществляется через последовательный порт.


## Интерфейс PC
Порты В/В:
0x0120, 0х0121 - порт данных (Port 67)
0x0122 - порт статуса и управления (Port 89)
Чтение:
	3 - "1" = поступили данные от контроллера
	4 - "1" = порт данных занят, данные еще НЕ прочитаны контроллером
	5 - контроллер выход T1/Port3.5
	6 - "1" = разрешено прерывание
	7 - перемычка SA.8

Запись
	6 - "1" = разрешить прерывание
	7 - ресет контроллера. После перезагрузки PC контроллер находится в ресете и надо записать "0" в этот бит для старта платы.

Прерывание 11 (может быть изменено на 2 джампером IRQ) - выход MCU T0/Port3.4 разрешается записью "1" в бит 6 регистра управления.

## Описание микропрограммы
[Требуется помощь]

## Сетевой протокол
[Требуется помощь]